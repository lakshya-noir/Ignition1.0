<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ESP32 Telemetry — Demo</title>
  <style>
    :root{
      --bg1:#060013;
      --bg2:#1a0632;
      --panel:rgba(255,255,255,0.04);
      --neon:#7efc8a;
      --neon-2:#9bff6f;
      --accent:#a78bfa;
      --muted:rgba(200,200,255,0.18);
      --glass:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      --card-border: rgba(167,139,250,0.06);
    }

    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial}
    body{
      background: radial-gradient(800px 400px at 10% 10%, rgba(167,139,250,0.06), transparent 8%),
                  radial-gradient(700px 350px at 90% 90%, rgba(126,252,138,0.02), transparent 6%),
                  linear-gradient(180deg,var(--bg1), var(--bg2));
      color: #e8f8ef;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      padding:28px;
    }

    /* Layout */
    .container{max-width:1100px;margin:0 auto;}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .title{
      display:flex;gap:14px;align-items:center;
    }
    .brand{
      display:flex;flex-direction:column;
    }
    h1{margin:0;font-size:26px;color:var(--neon);letter-spacing:0.5px}
    .subtitle{font-size:12px;color:rgba(178,255,198,0.8);margin-top:4px}

    /* Sparkles canvas wrapper */
    .spark-wrap{width:86px;height:86px;position:relative}
    #sparkCanvas{position:absolute;left:0;top:0;width:86px;height:86px;pointer-events:none}

    /* Controls */
    .controls{display:flex;gap:8px;align-items:center}
    .input{padding:8px 10px;border-radius:8px;border:1px solid var(--card-border);background:transparent;color:inherit;font-size:13px}
    .btn{padding:8px 12px;border-radius:8px;border:1px solid rgba(126,252,138,0.12);background:transparent;color:var(--neon);cursor:pointer}
    .btn.primary{background:linear-gradient(90deg, rgba(126,252,138,0.06), rgba(167,139,250,0.02));border-color:rgba(126,252,138,0.25)}

    /* Grid */
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;margin-top:22px}
    .card{
      background:var(--glass);
      border:1px solid var(--card-border);
      padding:14px;border-radius:14px;box-shadow:0 10px 30px rgba(3,3,10,0.6);
      backdrop-filter: blur(6px);
    }
    .label{font-size:12px;color:var(--accent);text-transform:uppercase}
    .value{font-weight:800;font-size:20px;color:var(--neon-2);margin-top:6px}

    /* Big chart card */
    .chart-card{grid-column:span 2;display:flex;flex-direction:column;gap:10px}
    #chart{width:100%;height:280px;border-radius:10px;background:linear-gradient(180deg, rgba(30,6,50,0.06), rgba(5,2,10,0.02));}

    /* Styled small boxes */
    .stats-row{display:flex;gap:10px;margin-top:10px}
    .mini{flex:1;padding:10px;border-radius:10px;background:transparent;border:1px solid rgba(126,252,138,0.04);text-align:center}
    .mini .num{font-weight:800;color:var(--neon-2);font-size:18px;margin-top:6px}

    footer{margin-top:18px;text-align:center;color:rgba(170,255,190,0.35);font-size:13px}

    /* sparkle particles (in DOM too for small decorative ones) */
    .spark-emoji{font-size:14px;color:var(--neon-2);transform:translateY(-2px)}
    /* responsive */
    @media (max-width:880px){
      .grid{grid-template-columns:1fr; }
      .chart-card{grid-column:span 1}
      header{flex-direction:column;align-items:flex-start;gap:12px}
      .controls{width:100%;justify-content:space-between}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="title">
        <div class="spark-wrap" aria-hidden="true">
          <canvas id="sparkCanvas" width="86" height="86"></canvas>
          <!-- small fallback decorative emoji -->
          <div style="width:86px;height:86px;display:flex;align-items:center;justify-content:center;">
            <div style="width:54px;height:54px;border-radius:50%;background:linear-gradient(135deg,rgba(167,139,250,0.16), rgba(126,252,138,0.06));display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--neon)"><span style="font-size:18px">ESP</span></div>
          </div>
        </div>

        <div class="brand">
          <h1>ESP32 Telemetry — Demo</h1>
          <div class="subtitle">Purple × Neon Green • Fake live data for showcasing ✨</div>
        </div>
      </div>

      <div class="controls">
        <input class="input" id="nameInput" placeholder="Presenter name (optional)" />
        <button class="btn primary" id="btnStart">Make it live</button>
        <button class="btn" id="btnStop">Stop</button>
      </div>
    </header>

    <main>
      <div class="grid">
        <div class="card">
          <div class="label">Accel X</div>
          <div id="ax" class="value">0.000 m/s²</div>
          <div style="margin-top:10px;color:rgba(170,180,255,0.18);font-size:12px">Simulated X-axis acceleration</div>
        </div>

        <div class="card">
          <div class="label">Accel Y</div>
          <div id="ay" class="value">0.000 m/s²</div>
          <div style="margin-top:10px;color:rgba(170,180,255,0.18);font-size:12px">Simulated Y-axis acceleration</div>
        </div>

        <div class="card">
          <div class="label">Accel Z</div>
          <div id="az" class="value">0.000 m/s²</div>
          <div style="margin-top:10px;color:rgba(170,180,255,0.18);font-size:12px">Simulated Z-axis acceleration</div>
        </div>

        <div class="card chart-card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <div class="label">Realtime Chart</div>
              <div style="font-weight:700;color:var(--neon-2);">AX / AY / AZ • Last 120 samples</div>
            </div>
            <div style="font-size:12px;color:rgba(180,220,200,0.7)"><span class="spark-emoji">✨</span> Decorative demo</div>
          </div>
          <canvas id="chart"></canvas>
          <div class="stats-row">
            <div class="mini">
              <div class="label">Speed</div>
              <div id="speed" class="num">0.00 m/s</div>
            </div>
            <div class="mini">
              <div class="label">Peak Speed</div>
              <div id="peak" class="num">0.00</div>
            </div>
            <div class="mini">
              <div class="label">Samples</div>
              <div id="count" class="num">0</div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="label">LED Control (demo)</div>
          <div style="display:flex;gap:8px;margin-top:12px">
            <button class="btn primary" id="ledOn">Turn LED ON</button>
            <button class="btn" id="ledOff">Turn LED OFF</button>
          </div>
          <div style="margin-top:12px">
            <div class="label">LED State</div>
            <div id="ledState" class="value">OFF</div>
          </div>

          <div style="margin-top:14px">
            <div class="label">Notes</div>
            <div style="font-size:13px;color:rgba(200,230,210,0.75);margin-top:6px">
              This demo page runs fully locally with simulated data. When presenting, click <strong>Make it live</strong> to start motion.
            </div>
          </div>
        </div>
      </div>
    </main>

    <footer>Saved as <code>index.html</code> — open it in your browser. Want the file tweaked for your logo or a different color? Tell me and I’ll edit it.</footer>
  </div>

<script>
/* --------------- Sparkle particles for header --------------- */
(function sparkles(){
  const c = document.getElementById('sparkCanvas');
  if (!c) return;
  const ctx = c.getContext('2d');
  const W = c.width, H = c.height;
  const parts = [];
  const max = 22;

  function rnd(a,b){ return Math.random()*(b-a)+a; }

  for(let i=0;i<max;i++){
    parts.push({
      x: rnd(10,W-10),
      y: rnd(10,H-10),
      vx: rnd(-0.15,0.15),
      vy: rnd(-0.25,0.25),
      size: rnd(1.2,3.6),
      life: rnd(60,220),
      hue: rnd(130,280)
    });
  }

  function draw(){
    ctx.clearRect(0,0,W,H);
    parts.forEach(p=>{
      p.x += p.vx;
      p.y += p.vy;
      p.life -= 0.6;
      if (p.life < 0){
        p.x = rnd(18,W-18); p.y = rnd(18,H-18);
        p.vx = rnd(-0.15,0.15); p.vy = rnd(-0.25,0.25);
        p.size = rnd(1.2,3.6); p.life = rnd(60,220); p.hue = rnd(130,280);
      }
      // glow
      const g = ctx.createRadialGradient(p.x,p.y,p.size*0.2,p.x,p.y,p.size*6);
      g.addColorStop(0, `hsla(${p.hue},80%,70%,0.95)`);
      g.addColorStop(0.25, `hsla(${p.hue},80%,65%,0.5)`);
      g.addColorStop(1, `rgba(15,6,30,0)`);
      ctx.fillStyle = g;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.size*3,0,Math.PI*2); ctx.fill();

      // core
      ctx.fillStyle = `hsla(${p.hue},90%,75%,1)`;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,Math.PI*2); ctx.fill();
    });
    requestAnimationFrame(draw);
  }
  draw();
})();

/* --------------- Simulated telemetry + chart --------------- */
(function telemetry(){
  const axEl = document.getElementById('ax');
  const ayEl = document.getElementById('ay');
  const azEl = document.getElementById('az');
  const speedEl = document.getElementById('speed');
  const peakEl = document.getElementById('peak');
  const countEl = document.getElementById('count');
  const ledStateEl = document.getElementById('ledState');
  const btnStart = document.getElementById('btnStart');
  const btnStop = document.getElementById('btnStop');
  const ledOn = document.getElementById('ledOn');
  const ledOff = document.getElementById('ledOff');

  const canvas = document.getElementById('chart');
  const ctx = canvas.getContext('2d');
  // pixel ratio for crispness
  const DPR = window.devicePixelRatio || 1;
  canvas.width = canvas.clientWidth * DPR;
  canvas.height = canvas.clientHeight * DPR;
  ctx.scale(DPR, DPR);

  let running = false;
  let interval = null;
  const history = { ax:[], ay:[], az:[], time:[] };
  let peakSpeed = 0;
  let ledOnState = false;

  function pushSample(sample){
    history.ax.push(sample.ax); history.ay.push(sample.ay); history.az.push(sample.az); history.time.push(Date.now());
    if (history.ax.length > 120){
      history.ax.shift(); history.ay.shift(); history.az.shift(); history.time.shift();
    }
    // update DOM
    axEl.textContent = sample.ax.toFixed(3) + ' m/s²';
    ayEl.textContent = sample.ay.toFixed(3) + ' m/s²';
    azEl.textContent = sample.az.toFixed(3) + ' m/s²';
    speedEl.textContent = sample.speed.toFixed(2) + ' m/s';
    if (sample.speed > peakSpeed) peakSpeed = sample.speed;
    peakEl.textContent = peakSpeed.toFixed(2);
    countEl.textContent = history.ax.length;
    drawChart();
  }

  // create smooth demo signals
  let t0 = Date.now();
  function genSample(){
    const t = (Date.now() - t0)/1000;
    // synthetic waveforms + a bit of randomness
    const ax = Math.sin(t*1.7)*1.2 + Math.sin(t*0.5)*0.4 + (Math.random()-0.5)*0.18;
    const ay = Math.cos(t*1.2)*1.0 + Math.sin(t*0.9)*0.25 + (Math.random()-0.5)*0.15;
    const az = 1 + Math.sin(t*0.6)*0.35 + (Math.random()-0.5)*0.12;
    // crude speed estimate from ax integrated
    // integrate with small dt, but here we simulate a nice-looking speed
    const speed = Math.abs(Math.sin(t*0.35)*6 + Math.sin(t*0.9)*1.5 + (Math.random()-0.5)*0.6);
    return { ax, ay, az, speed };
  }

  // chart drawing
  function drawChart(){
    const w = canvas.clientWidth;
    const h = canvas.clientHeight;
    ctx.clearRect(0,0,w,h);

    // background grid
    ctx.fillStyle = 'rgba(6,3,18,0.6)';
    ctx.fillRect(0,0,w,h);

    ctx.strokeStyle = 'rgba(126,252,138,0.06)';
    ctx.lineWidth = 1;
    for(let i=0;i<5;i++){
      ctx.beginPath(); ctx.moveTo(0, (i+1)*(h/6)); ctx.lineTo(w, (i+1)*(h/6)); ctx.stroke();
    }

    // helper to draw line from history
    function drawLine(arr, color){
      ctx.beginPath();
      ctx.lineWidth = 2.2;
      ctx.strokeStyle = color;
      const n = arr.length;
      if (n === 0) return;
      for (let i=0;i<n;i++){
        const x = (i/(n-1||1))*w;
        const v = arr[i]; // expect roughly -4..+4 or 0..2 for az
        // map v to y (center)
        const mapped = h/2 - (v/6)*(h*0.9);
        if (i===0) ctx.moveTo(x,mapped); else ctx.lineTo(x,mapped);
      }
      ctx.stroke();
      // glow
      ctx.shadowColor = color; ctx.shadowBlur = 12;
      ctx.stroke();
      ctx.shadowBlur = 0;
    }

    drawLine(history.ax, 'rgba(126,252,138,0.95)'); // ax green
    drawLine(history.ay, 'rgba(167,139,250,0.92)'); // ay purple
    drawLine(history.az, 'rgba(96,165,250,0.9)');   // az blue-ish

    // small legend
    ctx.fillStyle = 'rgba(220,255,210,0.12)';
    ctx.fillRect(10,8,120,28);
    ctx.fillStyle = '#b4ffd0'; ctx.font = '12px Inter, system-ui';
    ctx.fillText('AX (green)  AY (purple)  AZ (blue)', 16, 26);
  }

  function startSim(){
    if (running) return;
    running = true;
    t0 = Date.now();
    interval = setInterval(()=>{
      const s = genSample();
      pushSample(s);
    }, 220);
  }
  function stopSim(){
    running = false;
    if (interval) { clearInterval(interval); interval = null; }
  }

  // buttons
  document.getElementById('btnStart').addEventListener('click', ()=>{
    startSim();
  });
  document.getElementById('btnStop').addEventListener('click', ()=>{
    stopSim();
  });

  ledOn.addEventListener('click', ()=>{
    ledOnState = true; ledStateEl.textContent = 'ON'; ledStateEl.style.color = 'var(--neon-2)';
    // tiny sparkle when clicked
    flashHeader();
  });
  ledOff.addEventListener('click', ()=>{
    ledOnState = false; ledStateEl.textContent = 'OFF'; ledStateEl.style.color = '#e8f8ef';
    flashHeader();
  });

  // small header flash for feedback
  function flashHeader(){
    const el = document.querySelector('header');
    el.animate([{boxShadow:'0 0 0 rgba(0,0,0,0)'},{boxShadow:'0 0 24px rgba(126,252,138,0.06)'}], {duration:280, easing:'ease-out'});
  }

  // auto-start small burst so it feels alive immediately
  startSim();
  // ensure initial chart drawn
  drawChart();
})();
</script>
</body>
</html>
